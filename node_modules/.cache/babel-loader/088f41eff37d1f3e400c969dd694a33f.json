{"ast":null,"code":"!function (e, t) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? t(exports) : \"function\" == typeof define && define.amd ? define(\"querybase\", [\"exports\"], t) : t(e.querybase = e.querybase || {});\n}(this, function (e) {\n  \"use strict\";\n\n  function t(e, t) {\n    return new o(e, t);\n  }\n\n  var r = {\n    indexKey: function () {\n      return \"~~\";\n    },\n    isCommonJS: function () {\n      return \"undefined\" != typeof module;\n    },\n    isString: function (e) {\n      return \"string\" == typeof e || e instanceof String;\n    },\n    isObject: function (e) {\n      return null !== e && \"object\" == typeof e;\n    },\n    hasMultipleCriteria: function (e) {\n      return e.length > 1;\n    },\n    createKey: function (e, t) {\n      return \"\" + e + r.indexKey() + t;\n    },\n    getPathFromRef: function (e) {\n      var t = 3,\n          r = e.toString().split(\"/\");\n      return r.slice(t, r.length).join(\"/\");\n    },\n    merge: function (e, t) {\n      var r = {};\n\n      for (var n in e) r[n] = e[n];\n\n      for (var n in t) r[n] = t[n];\n\n      return r;\n    },\n    keys: function (e) {\n      return Object.keys(e);\n    },\n    values: function (e) {\n      return Object.keys(e).map(function (t) {\n        return e[t];\n      });\n    },\n    encodeBase64: function (e) {\n      return this.isCommonJS() ? new Buffer(e).toString(\"base64\") : window.btoa(e);\n    },\n    arraysToObject: function (e, t) {\n      var r = {},\n          n = 0;\n      return e.forEach(function (e) {\n        var o = t[n];\n        r[e] = o, n++;\n      }), r;\n    },\n    lexicographicallySort: function (e, t) {\n      return e.localeCompare(t);\n    },\n    getKeyIndexPositions: function (e) {\n      var t = {};\n      return e.forEach(function (e, r) {\n        return t[e] = r;\n      }), t;\n    },\n    createSortedObject: function (e, t) {\n      var r = {},\n          n = this.getKeyIndexPositions(e),\n          o = e.sort(this.lexicographicallySort);\n      return o.forEach(function (e) {\n        var o = n[e];\n        r[e] = t[o];\n      }), r;\n    },\n    sortObjectLexicographically: function (e) {\n      var t = this.keys(e),\n          r = this.values(e);\n      return this.createSortedObject(t, r);\n    }\n  },\n      n = function () {\n    function e(e) {\n      this.query = function () {\n        return e;\n      };\n    }\n\n    return e.prototype.lessThan = function (e) {\n      return this.query().endAt(e);\n    }, e.prototype.greaterThan = function (e) {\n      return this.query().startAt(e);\n    }, e.prototype.equalTo = function (e) {\n      return this.query().equalTo(e);\n    }, e.prototype.startsWith = function (e) {\n      return this.query().startAt(e).endAt(e + \"\");\n    }, e.prototype.between = function (e, t) {\n      return this.query().startAt(e).endAt(t);\n    }, e;\n  }(),\n      o = function () {\n    function e(e, t) {\n      var n = this;\n      this.INDEX_LENGTH = 3, this._assertFirebaseRef(e), this._assertIndexes(t), this._assertIndexLength(t), this.ref = function () {\n        return e;\n      }, this.indexOn = function () {\n        return t.sort(r.lexicographicallySort);\n      }, this.key = this.ref().key, this.encodedKeys = function () {\n        return n.encodeKeys(n.indexOn());\n      };\n    }\n\n    return e.prototype._assertFirebaseRef = function (e) {\n      if (null === e || void 0 === e || !e.on) throw new Error(\"No Firebase Database Reference provided in the Querybase constructor.\");\n    }, e.prototype._assertIndexes = function (e) {\n      if (null === e || void 0 === e) throw new Error(\"No indexes provided in the Querybase constructor. Querybase uses the indexOn() getter to create the composite queries for the where() method.\");\n    }, e.prototype._assertIndexLength = function (e) {\n      if (e.length > this.INDEX_LENGTH) throw new Error(\"Querybase supports only \" + this.INDEX_LENGTH + \" indexes for multiple querying.\");\n    }, e.prototype.set = function (e, t) {\n      var r = this.indexify(e);\n      return this.ref().set(r, t);\n    }, e.prototype.update = function (e, t) {\n      var r = this.indexify(e);\n      return this.ref().update(r);\n    }, e.prototype.push = function (e, t) {\n      if (!e) return this.ref().push();\n      if (1 === r.keys(e).length) return this.ref().push(e);\n      var n = this.indexify(e),\n          o = r.merge(n, e),\n          i = this.ref().push();\n      return i.set(o, t), i;\n    }, e.prototype.remove = function (e) {\n      return this.ref().remove(e);\n    }, e.prototype.child = function (t, r) {\n      return new e(this.ref().child(t), r);\n    }, e.prototype._createQueryPredicate = function (e) {\n      var t = r.sortObjectLexicographically(e),\n          n = r.keys(t),\n          o = r.values(t);\n      if (this._warnAboutIndexOnRule(), !r.hasMultipleCriteria(n)) return {\n        predicate: n[0],\n        value: o[0]\n      };\n      var i = this.encodeKey(n.join(r.indexKey())),\n          u = this.encodeKey(o.join(r.indexKey()));\n      return {\n        predicate: i,\n        value: u\n      };\n    }, e.prototype._createChildOrderedQuery = function (e) {\n      return new n(this.ref().orderByChild(e));\n    }, e.prototype._createEqualToQuery = function (e) {\n      return this.ref().orderByChild(e.predicate).equalTo(e.value);\n    }, e.prototype.where = function (e) {\n      if (r.isString(e)) return this._createChildOrderedQuery(e);\n\n      var t = this._createQueryPredicate(e);\n\n      return this._createEqualToQuery(t);\n    }, e.prototype._createCompositeIndex = function (e, t, n) {\n      if (!Array.isArray(e)) throw new Error(\"_createCompositeIndex expects an array for the first parameter: found \" + e);\n      if (0 === e.length) throw new Error(\"_createCompositeIndex expect an array with multiple elements for the first parameter. Found an array with length of \" + e.length);\n      if (!r.isObject(t)) throw new Error(\"_createCompositeIndex expects an object for the second parameter: found \" + t);\n      var o = e.slice(),\n          i = o.shift();\n      return n = n || {}, o.forEach(function (e) {\n        var u = \"\",\n            s = \"\";\n        n[r.createKey(i, e)] = r.createKey(t[i], t[e]), o.forEach(function (e) {\n          u = r.createKey(u, e), s = r.createKey(s, t[e]);\n        }), n[i + u] = t[i] + s;\n      }), 0 !== o.length && this._createCompositeIndex(o, t, n), n;\n    }, e.prototype._encodeCompositeIndex = function (e) {\n      if (!r.isObject(e)) throw new Error(\"_encodeCompositeIndex expects an object: found \" + e.toString());\n      var t = r.values(e),\n          n = r.keys(e),\n          o = this.encodeKeys(t),\n          i = this.encodeKeys(n);\n      return r.arraysToObject(i, o);\n    }, e.prototype.indexify = function (e) {\n      var t = this._createCompositeIndex(this.indexOn(), e),\n          r = this._encodeCompositeIndex(t);\n\n      return r;\n    }, e.prototype.encodeKey = function (e) {\n      return \"querybase\" + r.indexKey() + r.encodeBase64(e);\n    }, e.prototype.encodeKeys = function (e) {\n      var t = this;\n      return e.map(function (e) {\n        return t.encodeKey(e);\n      });\n    }, e.prototype._warnAboutIndexOnRule = function () {\n      var e = this.encodedKeys(),\n          t = '\\n\"' + r.getPathFromRef(this.ref()) + '\": {\\n  \".indexOn\": [' + r.keys(e).map(function (t) {\n        return '\"' + e[t] + '\"';\n      }).join(\", \") + \"]\\n}\";\n      console.warn(\"If you haven't yet, add this rule to drastically improve performance of your Realtime Database queries: \\n \" + t);\n    }, e;\n  }();\n\n  e.ref = t, e.Querybase = o, e.QuerybaseQuery = n, e.QuerybaseUtils = r, Object.defineProperty(e, \"__esModule\", {\n    value: !0\n  });\n});","map":{"version":3,"sources":["C:/Users/dhaval agrawal/OneDrive/Desktop/triprtrail/node_modules/querybase/dist/querybase.umd.min.js"],"names":["e","t","exports","module","define","amd","querybase","o","r","indexKey","isCommonJS","isString","String","isObject","hasMultipleCriteria","length","createKey","getPathFromRef","toString","split","slice","join","merge","n","keys","Object","values","map","encodeBase64","Buffer","window","btoa","arraysToObject","forEach","lexicographicallySort","localeCompare","getKeyIndexPositions","createSortedObject","sort","sortObjectLexicographically","query","prototype","lessThan","endAt","greaterThan","startAt","equalTo","startsWith","between","INDEX_LENGTH","_assertFirebaseRef","_assertIndexes","_assertIndexLength","ref","indexOn","key","encodedKeys","encodeKeys","on","Error","set","indexify","update","push","i","remove","child","_createQueryPredicate","_warnAboutIndexOnRule","predicate","value","encodeKey","u","_createChildOrderedQuery","orderByChild","_createEqualToQuery","where","_createCompositeIndex","Array","isArray","shift","s","_encodeCompositeIndex","console","warn","Querybase","QuerybaseQuery","QuerybaseUtils","defineProperty"],"mappings":"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","sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?t(exports):\"function\"==typeof define&&define.amd?define(\"querybase\",[\"exports\"],t):t(e.querybase=e.querybase||{})}(this,function(e){\"use strict\";function t(e,t){return new o(e,t)}var r={indexKey:function(){return\"~~\"},isCommonJS:function(){return\"undefined\"!=typeof module},isString:function(e){return\"string\"==typeof e||e instanceof String},isObject:function(e){return null!==e&&\"object\"==typeof e},hasMultipleCriteria:function(e){return e.length>1},createKey:function(e,t){return\"\"+e+r.indexKey()+t},getPathFromRef:function(e){var t=3,r=e.toString().split(\"/\");return r.slice(t,r.length).join(\"/\")},merge:function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},keys:function(e){return Object.keys(e)},values:function(e){return Object.keys(e).map(function(t){return e[t]})},encodeBase64:function(e){return this.isCommonJS()?new Buffer(e).toString(\"base64\"):window.btoa(e)},arraysToObject:function(e,t){var r={},n=0;return e.forEach(function(e){var o=t[n];r[e]=o,n++}),r},lexicographicallySort:function(e,t){return e.localeCompare(t)},getKeyIndexPositions:function(e){var t={};return e.forEach(function(e,r){return t[e]=r}),t},createSortedObject:function(e,t){var r={},n=this.getKeyIndexPositions(e),o=e.sort(this.lexicographicallySort);return o.forEach(function(e){var o=n[e];r[e]=t[o]}),r},sortObjectLexicographically:function(e){var t=this.keys(e),r=this.values(e);return this.createSortedObject(t,r)}},n=function(){function e(e){this.query=function(){return e}}return e.prototype.lessThan=function(e){return this.query().endAt(e)},e.prototype.greaterThan=function(e){return this.query().startAt(e)},e.prototype.equalTo=function(e){return this.query().equalTo(e)},e.prototype.startsWith=function(e){return this.query().startAt(e).endAt(e+\"\")},e.prototype.between=function(e,t){return this.query().startAt(e).endAt(t)},e}(),o=function(){function e(e,t){var n=this;this.INDEX_LENGTH=3,this._assertFirebaseRef(e),this._assertIndexes(t),this._assertIndexLength(t),this.ref=function(){return e},this.indexOn=function(){return t.sort(r.lexicographicallySort)},this.key=this.ref().key,this.encodedKeys=function(){return n.encodeKeys(n.indexOn())}}return e.prototype._assertFirebaseRef=function(e){if(null===e||void 0===e||!e.on)throw new Error(\"No Firebase Database Reference provided in the Querybase constructor.\")},e.prototype._assertIndexes=function(e){if(null===e||void 0===e)throw new Error(\"No indexes provided in the Querybase constructor. Querybase uses the indexOn() getter to create the composite queries for the where() method.\")},e.prototype._assertIndexLength=function(e){if(e.length>this.INDEX_LENGTH)throw new Error(\"Querybase supports only \"+this.INDEX_LENGTH+\" indexes for multiple querying.\")},e.prototype.set=function(e,t){var r=this.indexify(e);return this.ref().set(r,t)},e.prototype.update=function(e,t){var r=this.indexify(e);return this.ref().update(r)},e.prototype.push=function(e,t){if(!e)return this.ref().push();if(1===r.keys(e).length)return this.ref().push(e);var n=this.indexify(e),o=r.merge(n,e),i=this.ref().push();return i.set(o,t),i},e.prototype.remove=function(e){return this.ref().remove(e)},e.prototype.child=function(t,r){return new e(this.ref().child(t),r)},e.prototype._createQueryPredicate=function(e){var t=r.sortObjectLexicographically(e),n=r.keys(t),o=r.values(t);if(this._warnAboutIndexOnRule(),!r.hasMultipleCriteria(n))return{predicate:n[0],value:o[0]};var i=this.encodeKey(n.join(r.indexKey())),u=this.encodeKey(o.join(r.indexKey()));return{predicate:i,value:u}},e.prototype._createChildOrderedQuery=function(e){return new n(this.ref().orderByChild(e))},e.prototype._createEqualToQuery=function(e){return this.ref().orderByChild(e.predicate).equalTo(e.value)},e.prototype.where=function(e){if(r.isString(e))return this._createChildOrderedQuery(e);var t=this._createQueryPredicate(e);return this._createEqualToQuery(t)},e.prototype._createCompositeIndex=function(e,t,n){if(!Array.isArray(e))throw new Error(\"_createCompositeIndex expects an array for the first parameter: found \"+e);if(0===e.length)throw new Error(\"_createCompositeIndex expect an array with multiple elements for the first parameter. Found an array with length of \"+e.length);if(!r.isObject(t))throw new Error(\"_createCompositeIndex expects an object for the second parameter: found \"+t);var o=e.slice(),i=o.shift();return n=n||{},o.forEach(function(e){var u=\"\",s=\"\";n[r.createKey(i,e)]=r.createKey(t[i],t[e]),o.forEach(function(e){u=r.createKey(u,e),s=r.createKey(s,t[e])}),n[i+u]=t[i]+s}),0!==o.length&&this._createCompositeIndex(o,t,n),n},e.prototype._encodeCompositeIndex=function(e){if(!r.isObject(e))throw new Error(\"_encodeCompositeIndex expects an object: found \"+e.toString());var t=r.values(e),n=r.keys(e),o=this.encodeKeys(t),i=this.encodeKeys(n);return r.arraysToObject(i,o)},e.prototype.indexify=function(e){var t=this._createCompositeIndex(this.indexOn(),e),r=this._encodeCompositeIndex(t);return r},e.prototype.encodeKey=function(e){return\"querybase\"+r.indexKey()+r.encodeBase64(e)},e.prototype.encodeKeys=function(e){var t=this;return e.map(function(e){return t.encodeKey(e)})},e.prototype._warnAboutIndexOnRule=function(){var e=this.encodedKeys(),t='\\n\"'+r.getPathFromRef(this.ref())+'\": {\\n  \".indexOn\": ['+r.keys(e).map(function(t){return'\"'+e[t]+'\"'}).join(\", \")+\"]\\n}\";console.warn(\"If you haven't yet, add this rule to drastically improve performance of your Realtime Database queries: \\n \"+t)},e}();e.ref=t,e.Querybase=o,e.QuerybaseQuery=n,e.QuerybaseUtils=r,Object.defineProperty(e,\"__esModule\",{value:!0})});"]},"metadata":{},"sourceType":"script"}